<!DOCTYPE html>
<html>
<head>
    <title>Comptes</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <style>
        h1 {
            font-size: 10vw; /* Taille du texte en fonction de la largeur de la vue */
        }
        h2 {
            font-size: 8vw; /* Taille du texte en fonction de la largeur de la vue */
        }
        p {
            font-size: 6vw; /* Taille du texte en fonction de la largeur de la vue */
        }
        ul {
            list-style: none;
            padding: 0;
        }
        li {
            font-size: 5vw; /* Taille du texte en fonction de la largeur de la vue */
        }
        input {
            font-size: 6vw;
        }
        button {
            font-size: 6vw;
        }
    </style>
</head>
<body>
    <h1>Tableau de bord bancaire courant simplifié par mission</h1>
    
    <input type="file" id="fileInput" accept=".ods">
    <button onclick="readFile()">Lire le fichier ODS</button>
    
    <hr>
    <h2 style="color: deeppink;"><div id="cellContent0"></div></h2>
    <p style="color: cornflowerblue;"><div id="cellContent01"></div></p>

    <h2><div id="cellContent1"></div></h2>
    <ul>
        <li><div id="cellContent11"></div></li>
        <li><div id="cellContent12"></div></li>
        <li><div id="cellContent13"></div></li>
        <li><div id="cellContent14"></div></li>
    </ul>

    <h2><div id="cellContent2"></div></h2>
    <ul>
        <li><div id="cellContent21"></div></li>
        <li><div id="cellContent22"></div></li>
        <li><div id="cellContent23"></div></li>
    </ul>

    <h2><div id="cellContent3"></div></h2>
    <ul>
        <li><div id="cellContent31"></div></li>
        <li><div id="cellContent32"></div></li>
        <li><div id="cellContent33"></div></li>
        <li><div id="cellContent34"></div></li>
        <li><div id="cellContent35"></div></li>
    </ul>
    
    <script>
        function readFile() {
            const fileInput = document.getElementById('fileInput');
            const cellContentDiv0 = document.getElementById('cellContent0');
            const cellContentDiv01 = document.getElementById('cellContent01');
            const cellContentDiv1 = document.getElementById('cellContent1');
            const cellContentDiv11 = document.getElementById('cellContent11');
            const cellContentDiv12 = document.getElementById('cellContent12');
            const cellContentDiv13 = document.getElementById('cellContent13');
            const cellContentDiv14 = document.getElementById('cellContent14');
            const cellContentDiv2 = document.getElementById('cellContent2');
            const cellContentDiv21 = document.getElementById('cellContent21');
            const cellContentDiv22 = document.getElementById('cellContent22');
            const cellContentDiv23 = document.getElementById('cellContent23');
            const cellContentDiv3 = document.getElementById('cellContent3');
            const cellContentDiv31 = document.getElementById('cellContent31');
            const cellContentDiv32 = document.getElementById('cellContent32');
            const cellContentDiv33 = document.getElementById('cellContent33');
            const cellContentDiv34 = document.getElementById('cellContent34');
            const cellContentDiv35 = document.getElementById('cellContent35');
            
            // Vérifiez si un fichier a été sélectionné
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function (e) {
                    const data = new Uint8Array(e.target.result);
                    
                    // Lisez le fichier ODS en utilisant SheetJS
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Accédez à la première feuille (board) et aux cellules spécifiées
                    const firstSheet = workbook.Sheets['Board'];
                    cellContentDiv0.textContent = firstSheet['D4'] ? 'Ecourt comptable : ' + firstSheet['D4'].v + '€' : 'Cellule vide';
                    cellContentDiv01.textContent = firstSheet['C4'] ? 'Encourt bancaire : ' + firstSheet['C4'].v + '€' : 'Cellule vide';
                    cellContentDiv1.textContent = firstSheet['D6'] ? 'Mission besoins : ' + firstSheet['D6'].v + '€' : 'Cellule vide';
                    cellContentDiv11.textContent = firstSheet['D7'] ? 'Loyer : ' + firstSheet['D7'].v + '€' : 'Cellule vide';
                    cellContentDiv12.textContent = firstSheet['D8'] ? 'Factures : ' + firstSheet['D8'].v + '€' : 'Cellule vide';
                    cellContentDiv13.textContent = firstSheet['D9'] ? 'Transports : ' + firstSheet['D9'].v + '€' : 'Cellule vide';
                    cellContentDiv14.textContent = firstSheet['D10'] ? 'Alimentation : ' + firstSheet['D10'].v + '€' : 'Cellule vide';
                    cellContentDiv2.textContent = firstSheet['D11'] ? 'Mission loisirs : ' + firstSheet['D11'].v + '€' : 'Cellule vide';
                    cellContentDiv21.textContent = firstSheet['D12'] ? 'Sorties : ' + firstSheet['D12'].v + '€' : 'Cellule vide';
                    cellContentDiv22.textContent = firstSheet['D13'] ? 'Culture : ' + firstSheet['D13'].v + '€' : 'Cellule vide';
                    cellContentDiv23.textContent = firstSheet['D14'] ? 'Non-Alimentaire : ' + firstSheet['D14'].v + '€' : 'Cellule vide';
                    cellContentDiv3.textContent = 'Reliquats en cours';
                    cellContentDiv31.textContent = firstSheet['B31'] ? 'Transports : ' + firstSheet['B31'].v + '€' : 'Cellule vide';
                    cellContentDiv32.textContent = firstSheet['B32'] ? 'Sorties : ' + firstSheet['B32'].v + '€' : 'Cellule vide';
                    cellContentDiv33.textContent = firstSheet['B33'] ? 'Culture : ' + firstSheet['B33'].v + '€' : 'Cellule vide';
                    cellContentDiv34.textContent = firstSheet['B34'] ? 'Non-Alimentaire : ' + firstSheet['B34'].v + '€' : 'Cellule vide';
                    cellContentDiv35.textContent = firstSheet['B35'] ? 'PEA : ' + firstSheet['B35'].v + '€' : 'Cellule vide';
                };
                
                reader.readAsArrayBuffer(file);
            } else {
                alert('Sélectionnez un fichier ODS à lire.');
            }
        }
    </script>
</body>
</html>
